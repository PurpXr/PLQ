import base64;exec(base64.b64decode('aW1wb3J0IGFyZ3BhcnNlCgpwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcigpCgpwYXJzZXIuYWRkX2FyZ3VtZW50KCctcScsICctLXF1ZXJ5JywgaGVscD0iUXVlcnkgZmlsZSIsIHJlcXVpcmVkPVRydWUpCnBhcnNlci5hZGRfYXJndW1lbnQoJy1vJywgJy0tb3V0cHV0JywgaGVscD0iUXVlcnkgcmVzdWx0cyBkZXN0aW55IiwgcmVxdWlyZWQ9VHJ1ZSkKcGFyc2VyLmFkZF9hcmd1bWVudCgnLXAnLCAnLS1waG9uZScsIGhlbHA9IlNlYXJjaCBpbiBwaG9uZSBudW1iZXJzIiwgYWN0aW9uPSdzdG9yZV90cnVlJykKcGFyc2VyLmFkZF9hcmd1bWVudCgnLWUnLCAnLS1lbWFpbCcsIGhlbHA9IlNlYXJjaCBpbiBlbWFpbHMiLCBhY3Rpb249J3N0b3JlX3RydWUnKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCctcicsICctLW9yZGVycycsIGhlbHA9IlNlYXJjaCBpbiBvcmRlcnMiLCBhY3Rpb249J3N0b3JlX3RydWUnKQoKYXJncyA9IHBhcnNlci5wYXJzZV9hcmdzKCkKCnF1ZXJpZXMgPSBbXQpyZXMgPSBbXQp3aXRoIG9wZW4oYXJncy5xdWVyeSwgJ3JiJykgYXMgZjogIAogICAgcHJpbnQoIlF1ZXJ5OiIpCiAgICBmb3IgbGluZSBpbiBmLnJlYWRsaW5lcygpOgogICAgICAgIGxpbmUgPSBsaW5lLmRlY29kZSgndXRmLTgnKQogICAgICAgIGxpbmUgPSBsaW5lLnJlcGxhY2UoJ1xuJywgJycpCiAgICAgICAgcHJpbnQobGluZSkKICAgICAgICBxdWVyaWVzLmFwcGVuZChsaW5lKQogICAgICAgIAppZiBhcmdzLnBob25lOgogICAgd2l0aCBvcGVuKCcuL0h1c3RsZXIvUGhvbmVOdW1iZXJzUGFuZGEvUGhvbmVQYW5kYS5jc3YnLCAncmInKSBhcyBmOgogICAgICAgIHJlcy5hcHBlbmQoIi0tIFBIT05FIC0tXG4iKQogICAgICAgIGZvciBsaW5lIGluIGYucmVhZGxpbmVzKCk6ICAgCiAgICAgICAgICAgIGxpbmUgPSBsaW5lLmRlY29kZSgndXRmLTgnKSAgICAgICAgIAogICAgICAgICAgICBmb3IgcXVlcnkgaW4gcXVlcmllczoKICAgICAgICAgICAgICAgIGlmIHF1ZXJ5IGluIGxpbmU6CiAgICAgICAgICAgICAgICAgICAgcmVzLmFwcGVuZChsaW5lKQogICAgICAgICAgICAgICAgICAgIAppZiBhcmdzLmVtYWlsOgogICAgd2l0aCBvcGVuKCcuL0h1c3RsZXIvTG9naW5IaXN0b3J5L1BhbmRhYnV5LUVtYWlsLmNzdicsICdyYicpIGFzIGY6CiAgICAgICAgcmVzLmFwcGVuZCgiLS0gRU1BSUwgLS1cbiIpCiAgICAgICAgZm9yIGxpbmUgaW4gZi5yZWFkbGluZXMoKTogICAKICAgICAgICAgICAgbGluZSA9IGxpbmUuZGVjb2RlKCd1dGYtOCcpICAgICAgICAgCiAgICAgICAgICAgIGZvciBxdWVyeSBpbiBxdWVyaWVzOgogICAgICAgICAgICAgICAgaWYgcXVlcnkgaW4gbGluZToKICAgICAgICAgICAgICAgICAgICByZXMuYXBwZW5kKGxpbmUpCiAgICAgICAgICAgICAgICAgICAgCmlmIGFyZ3Mub3JkZXJzOgogICAgd2l0aCBvcGVuKCcuL0h1c3RsZXIvT3JkZXJzIEVtYWlscy9QYW5kYWJ1eS1PcmRlcnMuY3N2JywgJ3JiJykgYXMgZjoKICAgICAgICByZXMuYXBwZW5kKCItLSBPUkRFUlMgLS1cbiIpCiAgICAgICAgZm9yIGxpbmUgaW4gZi5yZWFkbGluZXMoKTogICAKICAgICAgICAgICAgbGluZSA9IGxpbmUuZGVjb2RlKCd1dGYtOCcpICAgICAgICAgCiAgICAgICAgICAgIGZvciBxdWVyeSBpbiBxdWVyaWVzOgogICAgICAgICAgICAgICAgaWYgcXVlcnkgaW4gbGluZToKICAgICAgICAgICAgICAgICAgICByZXMuYXBwZW5kKGxpbmUpCgoKd2l0aCBvcGVuKGFyZ3Mub3V0cHV0LCAnd2InKSBhcyBmOgogICAgcHJpbnQoZiJGb3VuZDoge2xlbihyZXMpLTN9IikKICAgIGZvciBsaW5lIGluIHJlczoKICAgICAgICBsaW5lID0gbGluZS5lbmNvZGUoJ3V0Zi04JykKICAgICAgICBmLndyaXRlKGxpbmUpCg=='))